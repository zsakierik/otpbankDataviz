rownames(data)=paste("mister" , letters[1:3] , sep="-")
data
radarchart(data)
radarchart(data[1,])
radarchart(data)
data=rbind(rep(20,5) , rep(0,5) , data)
radarchart(data)
data
colors_border=c( rgb(0.2,0.5,0.5,0.9), rgb(0.8,0.2,0.5,0.9) , rgb(0.7,0.5,0.1,0.9) )
colors_in=c( rgb(0.2,0.5,0.5,0.4), rgb(0.8,0.2,0.5,0.4) , rgb(0.7,0.5,0.1,0.4) )
radarchart( data  , axistype=1 ,
#custom polygon
pcol=colors_border , pfcol=colors_in , plwd=4 , plty=1,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", caxislabels=seq(0,20,5), cglwd=0.8,
#custom labels
vlcex=0.8
)
legend(x=0.7, y=1, legend = rownames(data[-c(1,2),]), bty = "n", pch=20 , col=colors_in , text.col = "grey", cex=1.2, pt.cex=3)
ugyfeltranzakcio_havi %>% group_by(MCC_CSOPORT) %>% summarise(sum = sum(TRX_OSSZEG)) %>% arrange(MCC_CSOPORT)
ugyfel_eves <- ugyfeltranzakcio_havi %>% group_by(MCC_CSOPORT) %>% summarise(sum = sum(TRX_OSSZEG)) %>% arrange(MCC_CSOPORT)
ugyfel_eves
ugyfel_eves %>% spread(MCC_CSOPORT, fill = 0, convert = FALSE)
library(tidyr)
ugyfel_eves %>% spread(MCC_CSOPORT, fill = 0, convert = FALSE)
ugyfel_eves
ugyfel_eves %>% spread(MCC_CSOPORT, fill = 0, convert = FALSE)
ugyfel_eves %>% spread(MCC_CSOPORT, sum fill = 0, convert = FALSE)
ugyfel_eves %>% spread(MCC_CSOPORT, sum, fill = 0, convert = FALSE)
ugyfel_eves %>% spread(sum, fill = 0, convert = FALSE)
dcast(melt(ugyfel_eves, id.vars = "MCC_CSOPORT"), variable ~ col0)
melt(ugyfel_eves, id.vars = "MCC_CSOPORT")
melt
library(data.table)
dcast(melt(ugyfel_eves, id.vars = "MCC_CSOPORT"), variable ~ col0)
library( reshape2)
dcast(melt(ugyfel_eves, id.vars = "MCC_CSOPORT"), variable ~ col0)
melt(ugyfel_eves, id.vars = "MCC_CSOPORT")
dcast(ugyfel_eves)
ugyfel_eves
ugyfel_eves %>% spread(sum, fill = 0, convert = FALSE)
ugyfel_eves %>% spread(MCC_CSOPORT,sum, fill = 0, convert = FALSE)
ugyfel_eves %>% spread(MCC_CSOPORT,sum, fill = 0)
ugyfel_eves %>% spread(MCC_CSOPORT,sum)
ugyfel_eves %>% spread(MCC_CSOPORT)
ugyfel_eves %>% spread(ugyfel_eves$MCC_CSOPORT)
spread(ugyfel_eves$MCC_CSOPORT)
library(plotly)
library(dplyr)
# Read in data
df ",
coords$Complaint, ":",
round(coords$Percent*100, 2), "%"))
# Plot
smooth %
add_trace(data = df,
x = x, y = y, mode = "markers",
marker = list(color = "white",
size = 10,
line = list(width = 2)),
hoverinfo = "none",
showlegend = F) %&gt;%
layout(xaxis = list(title = "", showgrid = F, zeroline = F, showticklabels = F,
domain = c(0.02, 0.48)),
yaxis = list(title = "", showgrid = F, zeroline = F, showticklabels = F,
domain = c(0, 0.92)),
font = list(family = "serif", size = 15),
legend = list(x = 0.55, y = 0.9, bgcolor = "transparent"),
plot_bgcolor = bgcolor,
paper_bgcolor = bgcolor)
# Add grids
grid America",
"Wells Fargo
&amp;Company",
"JP Morgan
Chase &amp; Co.",
"CitiBank",
"Capital One")
labels ", banks, "")
p Consumer complaints for five large banks in the U.S.",
font = list(family = "serif",
size = 25,
color = "#4080bf")),
list(xref = "paper", yref = "paper",
xanchor = "left", yanchor = "top",
x = 0.03, y = 0.95,
showarrow = F,
text = '<em>Source: Consumer Financial Protection Bureau</em>',
font = list(family = "serif",
size = 16,
color = "#679bcb")),
list(xref = "paper", yref = "paper",
xanchor = "left", yanchor = "top",
x = 0.60, y = 0.20,
showarrow = F,
align = "left",
text = "Complaints received by the Consumer Financial Protection Bureau
regarding financial products and services offered by five large banks in
in the United States expressed as a percentage of total nummber
of complaints.",
font = list(family = "arial",
size = 12)),
list(xref = "paper", yref = "paper",
xanchor = "left", yanchor = "top",
x = 0.60, y = 0.05,
showarrow = F,
align = "left",
text = '<a href="https://catalog.data.gov/dataset/consumer-complaint-database">Click here to go to source</a>',
font = list(family = "arial",
size = 14))
),
shapes = list(
list(
xref = "paper", yref = "paper",
x0 = 0, x1 = 0.95,
y0 = 0, y1 = 1,
type = "rect",
layer = "above",
fillcolor = "rgba(191, 191, 191, 0.1)",
line = list(color = "transparent"))
))
print(p)
df ",
coords$Complaint, ":",
round(coords$Percent*100, 2), "%"))
round(coords$Percent*100, 2), "%"))
df ",coords$Complaint, ":",round(coords$Percent*100, 2), "%"))
layout(p, radialaxis = list(ticksuffix = "%"), orientation = 270)
p <- plot_ly(plotly::wind, r = ~r, t = ~t) %>% add_area(color = ~nms)
layout(p, radialaxis = list(ticksuffix = "%"), orientation = 270)
plotly::wind
p <- plot_ly(plotly::wind, r = ~r, t = ~t) %>% add_area(color = ~nms)
add_area
plot_ly(plotly::wind, r = ~r, t = ~t)
packageVersion('plotly')
install.packages(plotly)
install.packages("plotly")
install.packages("plotly")
library(plotly)
packageVersion('plotly')
install.packages(c("data.table", "gplots", "tidyr"))
tranzakcio_havi <-  fread("otpbank_dataviz_verseny_adatok_199_321/tranzakcio_havi.csv")
library(data.table)
tranzakcio_havi <-  fread("otpbank_dataviz_verseny_adatok_199_321/tranzakcio_havi.csv")
ugyfelID <- 2259345
ugyfel[UGYFEL_ID == ugyfelID]
tranzakcio_havi[UGYFEL_ID == ugyfelID]
tranzakcio_havi$TRX_HONAP <- as.Date(tranzakcio_havi$TRX_HONAP, "%Y-%m-%d")
tranzakcio_havi$year  <- as.numeric(format(tranzakcio_havi$TRX_HONAP, "%Y"))
tranzakcio_havi$month  <- as.numeric(format(tranzakcio_havi$TRX_HONAP, "%m"))
ugyfeltranzakcio_havi <- tranzakcio_havi[UGYFEL_ID == ugyfelID]
ugyfeltranzakcio_havi
ugyfeltranzakcio_havi %>% group_by(MCC_CSOPORT) %>% summarise(sum = sum(TRX_OSSZEG))
library(dplyr)
ugyfeltranzakcio_havi %>% group_by(MCC_CSOPORT) %>% summarise(sum = sum(TRX_OSSZEG))
library(plotly)
plot_ly(plotly::wind, r = ~r, t = ~t)
data <- ugyfeltranzakcio_havi %>% group_by(MCC_CSOPORT) %>% summarise(sum = sum(TRX_OSSZEG))
plotly::wind
data
plot_ly(data, r = ~sum, t = ~MCC_CSOPORT)
data
data$type <- "sajat"
data
p <-plot_ly(data, r = ~sum, t = ~MCC_CSOPORT) %>% add_area(color = ~t)
plot_ly(data, r = ~sum, t = ~MCC_CSOPORT) %>% add_area(color = ~type)
data("diamonds")
plot_ly(diamonds, x = ~carat, y = ~price, color = ~clarity)
data("diamonds")
plot_ly(diamonds, x = ~carat, y = ~price, color = ~clarity)
plot_ly(diamonds, r = ~carat, t = ~price, color = ~clarity)
plot_ly(data, r = ~sum, t = ~MCC_CSOPORT) %>% add_area(color = ~type)
tranzakcio_havi
tranzakcio_havi %>% group_by(MCC_CSOPORT) %>% summarise(sum = sum(TRX_OSSZEG))
tranzakcio_havi %>% group_by(MCC_CSOPORT) %>% summarise(sum = sum(TRX_OSSZEG), frequency = n())
tranzakcio_havi %>% group_by(MCC_CSOPORT) %>% summarise(sum = sum(TRX_OSSZEG), frequency = n(), avg = mean(TRX_OSSZEG))
302546500/16234
tranzakcio_havi %>% group_by(MCC_CSOPORT) %>% summarise(avg = mean(TRX_OSSZEG))
tranzakcio_havi %>% group_by(MCC_CSOPORT) %>% summarise(avg = mean(TRX_OSSZEG))
tranzakcio_havi %>% group_by(MCC_CSOPORT) %>% summarise(avg = mean(TRX_OSSZEG)) %>% mutate(type = "mean")
tranzakcio_havi %>% group_by(MCC_CSOPORT) %>% summarise(sum = mean(TRX_OSSZEG)) %>% mutate(type = "mean")
data
mean_tranzakcio_havi <- tranzakcio_havi %>% group_by(MCC_CSOPORT) %>% summarise(sum = mean(TRX_OSSZEG)) %>% mutate(type = "mean")
full_join(mean_tranzakcio_havi,data)
p <-plot_ly(full_join(mean_tranzakcio_havi,data), r = ~sum, t = ~MCC_CSOPORT) %>% add_area(color = ~type)
p
ugyfeltranzakcio_havi <- ugyfeltranzakcio_havi %>% group_by(MCC_CSOPORT) %>% summarise(sum = sum(TRX_OSSZEG)) %>% mutate(type = "sajat")
data <- full_join(mean_tranzakcio_havi,ugyfeltranzakcio_havi)
data
p <-plot_ly(full_join(mean_tranzakcio_havi,data), r = ~sum, t = ~MCC_CSOPORT) %>% add_area(color = ~type)
layout(p, radialaxis = list(ticksuffix = "%"), orientation = 270)
ugyfel <- fread("otpbank_dataviz_verseny_adatok_199_321/ugyfel.csv")
ugyfel[UGYFEL_ID == ugyfelID]
ugyfel[UGYFEL_ID == ugyfelID, UGYFEL_ID]
ugyfel[UGYFEL_ID == ugyfelID, (UGYFEL_ID,UGYFEL_NEME)]
ugyfel[UGYFEL_ID == ugyfelID, .(UGYFEL_ID,UGYFEL_NEME)]
ugyfel[UGYFEL_ID == ugyfelID, .(UGYFEL_ID,UGYFEL_NEME,UGYFEL_CSALADI_ALLAPOT,UGYFEL_ISKOLAI_VEGZETTSEGE)]
szegmens <- ugyfel[UGYFEL_ID == ugyfelID, .(UGYFEL_NEME,UGYFEL_CSALADI_ALLAPOT,UGYFEL_ISKOLAI_VEGZETTSEGE)]
szegmens
ugyfel[UGYFEL_NEME == szegmens$UGYFEL_NEME &
UGYFEL_CSALADI_ALLAPOT == szegmens$UGYFEL_CSALADI_ALLAPOT &
UGYFEL_ISKOLAI_VEGZETTSEGE == szegmens$UGYFEL_ISKOLAI_VEGZETTSEGE, UGYFEL_ID]
ugyfel[UGYFEL_NEME == szegmens$UGYFEL_NEME &
UGYFEL_CSALADI_ALLAPOT == szegmens$UGYFEL_CSALADI_ALLAPOT &
UGYFEL_ISKOLAI_VEGZETTSEGE == szegmens$UGYFEL_ISKOLAI_VEGZETTSEGE,]
szegmens <- ugyfel[UGYFEL_ID == ugyfelID, .(UGYFEL_NEME,UGYFEL_CSALADI_ALLAPOT,UGYFEL_ISKOLAI_VEGZETTSEGE)]
szegmens
ugyfel[UGYFEL_NEME == szegmens$UGYFEL_NEME &
UGYFEL_CSALADI_ALLAPOT == szegmens$UGYFEL_CSALADI_ALLAPOT &
UGYFEL_ISKOLAI_VEGZETTSEGE == szegmens$UGYFEL_ISKOLAI_VEGZETTSEGE,]
szegmens_tranzakcio_havi<- ugyfel[UGYFEL_NEME == szegmens$UGYFEL_NEME &
UGYFEL_CSALADI_ALLAPOT == szegmens$UGYFEL_CSALADI_ALLAPOT &
UGYFEL_ISKOLAI_VEGZETTSEGE == szegmens$UGYFEL_ISKOLAI_VEGZETTSEGE,]
szegmens_tranzakcio_havi
szegmens_ugyfelID<- ugyfel[UGYFEL_NEME == szegmens$UGYFEL_NEME &
UGYFEL_CSALADI_ALLAPOT == szegmens$UGYFEL_CSALADI_ALLAPOT &
UGYFEL_ISKOLAI_VEGZETTSEGE == szegmens$UGYFEL_ISKOLAI_VEGZETTSEGE,UGYFEL_ID]
szegmens_ugyfelID
tranzakcio_havi %>% filter(UGYFEL_ID %in% szegmens_ugyfelID)
mean_szegmens_tranzakcio_havi <- tranzakcio_havi %>% filter(UGYFEL_ID %in% szegmens_ugyfelID) %>% group_by(MCC_CSOPORT) %>% summarise(sum = mean(TRX_OSSZEG)) %>% mutate(type = "szegmens")
mean_szegmens_tranzakcio_havi
mean_tranzakcio_havi
data <- full_join(mean_tranzakcio_havi,ugyfeltranzakcio_havi,mean_szegmens_tranzakcio_havi)
data <- full_join(data,mean_szegmens_tranzakcio_havi)
data
p <-plot_ly(full_join(mean_tranzakcio_havi,data), r = ~sum, t = ~MCC_CSOPORT) %>% add_area(color = ~type)
layout(p, radialaxis = list(ticksuffix = "%"), orientation = 270)
ugyfeltranzakcio_havi
data
View(data)
szegmens
szegmens_ugyfelID
ugyfelID <- 6663177
ugyfeltranzakcio_havi <- tranzakcio_havi[UGYFEL_ID == ugyfelID]
ugyfeltranzakcio_havi <- ugyfeltranzakcio_havi %>% group_by(MCC_CSOPORT) %>% summarise(sum = sum(TRX_OSSZEG)) %>% mutate(type = "sajat")
ugyfeltranzakcio_havi
data <- full_join(mean_tranzakcio_havi,ugyfeltranzakcio_havi)
data <- full_join(data,mean_szegmens_tranzakcio_havi)
p <-plot_ly(full_join(mean_tranzakcio_havi,data), r = ~sum, t = ~MCC_CSOPORT) %>% add_area(color = ~type)
layout(p, radialaxis = list(ticksuffix = "%"), orientation = 270)
layout(p,  orientation = 270)
tranzakcio_havi
tranzakcio_havi %>% group_by(MCC_CSOPORT)
tranzakcio_havi %>% group_by(UGYFEL_ID,MCC_CSOPORT)
tranzakcio_havi %>% group_by(UGYFEL_ID,MCC_CSOPORT) %>% summarise(sum = mean(TRX_OSSZEG))
tranzakcio_havi %>% group_by(UGYFEL_ID,MCC_CSOPORT) %>% summarise(sum = mean(TRX_OSSZEG))
%>% group_by(MCC_CSOPORT)
tranzakcio_havi %>% group_by(UGYFEL_ID,MCC_CSOPORT) %>% summarise(sum = mean(TRX_OSSZEG)) %>% group_by(MCC_CSOPORT)
tranzakcio_havi %>% group_by(UGYFEL_ID,MCC_CSOPORT) %>% summarise(sum = mean(TRX_OSSZEG)) %>% group_by(MCC_CSOPORT) %>% summarise(sum = mean(sum))
mean_tranzakcio_havi
tranzakcio_havi %>% group_by(MCC_CSOPORT) %>% summarise(sum = mean(TRX_OSSZEG)) %>% mutate(type = "mean")
ugyfeltranzakcio_havi <- tranzakcio_havi[UGYFEL_ID == ugyfelID]
ugyfeltranzakcio_havi
ugyfeltranzakcio_havi %>% group_by(MCC_CSOPORT)
ugyfeltranzakcio_havi %>% group_by(MCC_CSOPORT) %>% summarise(sum = sum(TRX_OSSZEG))
tranzakcio_havi %>% group_by(UGYFEL_ID,MCC_CSOPORT) %>% summarise(sum = sum(TRX_OSSZEG))
tranzakcio_havi %>% group_by(UGYFEL_ID,MCC_CSOPORT) %>% summarise(sum = sum(TRX_OSSZEG)) group_by(MCC_CSOPORT) %>% summarise(sum = mean(sum))
tranzakcio_havi %>% group_by(UGYFEL_ID,MCC_CSOPORT) %>% summarise(sum = sum(TRX_OSSZEG)) %>% group_by(MCC_CSOPORT) %>% summarise(sum = mean(sum))
tmp <-  tranzakcio_havi %>% group_by(UGYFEL_ID,MCC_CSOPORT) %>% summarise(sum = sum(TRX_OSSZEG))
tmp
tmp[MCC_CSOPORT == "AUTO",]
tmp[tmp$MCC_CSOPORT == "AUTO",]
ugyfeltranzakcio_havi
ugyfeltranzakcio_havi <- tranzakcio_havi[UGYFEL_ID == ugyfelID]
ugyfeltranzakcio_havi <- ugyfeltranzakcio_havi %>% group_by(MCC_CSOPORT) %>% summarise(sum = sum(TRX_OSSZEG)) %>% mutate(type = "sajat")
ugyfeltranzakcio_havi
tmp[tmp$MCC_CSOPORT == "AUTO",]
mean(tmp$MCC_CSOPORT)
mean(tmp$MCC_CSOPORT, na.rm = TRUE)
tmp$MCC_CSOPORT
tmp[tmp$MCC_CSOPORT == "AUTO",]
tmp[tmp$MCC_CSOPORT == "AUTO",sum]
tmp[tmp$MCC_CSOPORT == "AUTO","sum"]
mean(tmp[tmp$MCC_CSOPORT == "AUTO","sum"])
tmp[tmp$MCC_CSOPORT == "AUTO","sum"]
tmp[MCC_CSOPORT == "AUTO","sum"]
mean(tmp[tmp$MCC_CSOPORT == "AUTO","sum"])
str(tmp)
summary(tmp)
tmp[tmp$MCC_CSOPORT == "AUTO","sum"]
mean(
as.numeric(tmp[tmp$MCC_CSOPORT == "AUTO","sum"])
)
as.numeric(tmp[tmp$MCC_CSOPORT == "AUTO","sum"])
as.vector(tmp[tmp$MCC_CSOPORT == "AUTO","sum"])
as.list(tmp[tmp$MCC_CSOPORT == "AUTO","sum"])
mean(
as.list(tmp[tmp$MCC_CSOPORT == "AUTO","sum"])
)
tmp %>% group_by(MCC_CSOPORT) %>% summarise(n = n())
tmp %>% group_by(MCC_CSOPORT) %>% summarise(n = sum(sum))
tmp %>% group_by(MCC_CSOPORT) %>% summarise(n = mean(sum))
ugyfeltranzakcio_havi
tranzakcio_havi %>% group_by(UGYFEL_ID,MCC_CSOPORT) %>% summarise(sum = sum(TRX_OSSZEG)) %>% group_by(MCC_CSOPORT) %>% summarise(sum = mean(sum))
mean_tranzakcio_havi <- tranzakcio_havi %>% group_by(UGYFEL_ID,MCC_CSOPORT) %>%
summarise(sum = sum(TRX_OSSZEG)) %>% group_by(MCC_CSOPORT)
%>% summarise(sum = mean(sum))
%>% mutate(type = "mean")
mean_tranzakcio_havi <- tranzakcio_havi %>% group_by(UGYFEL_ID,MCC_CSOPORT) %>%
summarise(sum = sum(TRX_OSSZEG)) %>% group_by(MCC_CSOPORT) %>%
summarise(sum = mean(sum))%>%
mutate(type = "mean")
mean_tranzakcio_havi
tranzakcio_havi %>% filter(UGYFEL_ID %in% szegmens_ugyfelID) %>%
group_by(UGYFEL_ID,MCC_CSOPORT) %>%
summarise(sum = sum(TRX_OSSZEG)) %>%
group_by(MCC_CSOPORT) %>% summarise(sum = mean(TRX_OSSZEG)) %>%
mutate(type = "szegmens")
tranzakcio_havi %>% filter(UGYFEL_ID %in% szegmens_ugyfelID) %>%
group_by(UGYFEL_ID,MCC_CSOPORT) %>%
summarise(sum = sum(TRX_OSSZEG)) %>%
group_by(MCC_CSOPORT) %>% summarise(sum = mean(sum)) %>%
mutate(type = "szegmens")
mean_tranzakcio_havi <- tranzakcio_havi %>% group_by(UGYFEL_ID,MCC_CSOPORT) %>%
summarise(sum = sum(TRX_OSSZEG)) %>% group_by(MCC_CSOPORT) %>%
summarise(sum = mean(sum))%>%
mutate(type = "mean")
mean_szegmens_tranzakcio_havi <- tranzakcio_havi %>% filter(UGYFEL_ID %in% szegmens_ugyfelID) %>%
group_by(UGYFEL_ID,MCC_CSOPORT) %>%
summarise(sum = sum(TRX_OSSZEG)) %>%
group_by(MCC_CSOPORT) %>% summarise(sum = mean(sum)) %>%
mutate(type = "szegmens")
ugyfeltranzakcio_havi <- tranzakcio_havi[UGYFEL_ID == ugyfelID]
ugyfeltranzakcio_havi <- ugyfeltranzakcio_havi %>% group_by(MCC_CSOPORT) %>% summarise(sum = sum(TRX_OSSZEG)) %>% mutate(type = "sajat")
data <- full_join(mean_tranzakcio_havi,ugyfeltranzakcio_havi)
data <- full_join(data,mean_szegmens_tranzakcio_havi)
p <-plot_ly(full_join(mean_tranzakcio_havi,data), r = ~sum, t = ~MCC_CSOPORT) %>% add_area(color = ~type)
data
p <-plot_ly(data, r = ~sum, t = ~MCC_CSOPORT) %>% add_area(color = ~type)
View(data)
p <-plot_ly(data, r = ~sum, t = ~MCC_CSOPORT) %>% add_area(color = ~type)
layout(p,  orientation = 270)
p <-plot_ly(data, r = ~sum, t = ~MCC_CSOPORT, fill = 'tozeroy') %>% add_area(color = ~type)
layout(p,  orientation = 270)
plot_ly(data, r = ~sum, t = ~MCC_CSOPORT) %>% add_area(color = ~type, fill = 'tozeroy')
p <-plot_ly(data, r = ~sum, t = ~MCC_CSOPORT) %>% add_area(color = ~type)
layout(p,  orientation = 270)
p <-plot_ly(data, r = ~sum, t = ~MCC_CSOPORT) %>% add_area(color = ~type)
layout(p,  orientation = 270, fill = 'tozeroy')
layout(p,  orientation = 360, fill = 'tozeroy')
layout(p,  orientation = 180, fill = 'tozeroy')
layout(p,  orientation = 270, fill = 'tozeroy')
layout(p,  orientation = 850, fill = 'tozeroy')
layout(p,  orientation = 0, fill = 'tozeroy')
layout(p,  orientation = 270, fill = 'tozeroy')
layout(p,  orientation = 270, showlegend = TRUE)
layout(p,  orientation = 270, showlegend = FALSE)
layout(p,  orientation = 270, legend = FALSE)
?layout
p <-plot_ly(data, r = ~sum, t = ~MCC_CSOPORT) %>% add_area(color = ~type, labels = TRUE)
layout(p,  orientation = 270)
p <-plot_ly(data, r = ~sum, t = ~MCC_CSOPORT) %>% add_area(color = ~type, labels = c("1","2"))
layout(p,  orientation = 270)
ugyfeltranzakcio_havi
tranzakcio_havi
library(ggplot2)
library(treemapify)
install.packages("treemapify")
library(treemapify)
proglangs <- read.csv("https://raw.githubusercontent.com/selva86/datasets/master/proglanguages.csv")
proglangs
# plot
treeMapCoordinates <- treemapify(proglangs,
area = "value",
fill = "parent",
label = "id",
group = "parent")
treeMapCoordinates
treeMapPlot <- ggplotify(treeMapCoordinates) +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
scale_fill_brewer(palette = "Dark2")
treeMapPlot
library(treemapify)
treeMapPlot <- ggplotify(treeMapCoordinates) +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
scale_fill_brewer(palette = "Dark2")
ggplotify
treeMapPlot <- ggplotly(treeMapCoordinates) +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
scale_fill_brewer(palette = "Dark2")
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("reshape2")
install.packages("plyr")
install.packages("plyr")
install.packages("devtools")
library(devtools)
library(treemapify)
treeMapPlot <- ggplotify(treeMapCoordinates) +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
scale_fill_brewer(palette = "Dark2")
library(ggplot2)
library(devtools)
library(ggplot2)
library(reshape2)
library(plyr)
library(treemapify)
install.packages("plyr")
install.packages("plyr")
library(plyr)
treeMapPlot <- ggplotify(treeMapCoordinates) +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
scale_fill_brewer(palette = "Dark2")
packageVersion('treemapify')
geom_treemap(treeMapCoordinates) +
scale_x_continuous(expand = c(0, 0)) +
scale_y_continuous(expand = c(0, 0)) +
scale_fill_brewer(palette = "Dark2")
G20
ggplot(G20, aes(area = gdp_mil_usd, fill = hdi, label = country,
subgroup = region)) +
geom_treemap() +
geom_treemap_subgroup_border() +
geom_treemap_subgroup_text(place = "centre", grow = T, alpha = 0.5, colour =
"black", fontface = "italic", min.size = 0) +
geom_treemap_text(colour = "white", place = "topleft", reflow = T)
ugyfelID <- 101553
szegmens <- ugyfel[UGYFEL_ID == ugyfelID, .(UGYFEL_NEME,UGYFEL_CSALADI_ALLAPOT,UGYFEL_ISKOLAI_VEGZETTSEGE)]
szegmens_ugyfelID<- ugyfel[UGYFEL_NEME == szegmens$UGYFEL_NEME &
UGYFEL_CSALADI_ALLAPOT == szegmens$UGYFEL_CSALADI_ALLAPOT &
UGYFEL_ISKOLAI_VEGZETTSEGE == szegmens$UGYFEL_ISKOLAI_VEGZETTSEGE,UGYFEL_ID]
ugyfeltranzakcio_havi %>% group_by(MCC_CSOPORT) %>% summarise(sum = sum(TRX_OSSZEG))
mean_tranzakcio_havi <- tranzakcio_havi %>% group_by(UGYFEL_ID,MCC_CSOPORT) %>%
summarise(sum = sum(TRX_OSSZEG)) %>% group_by(MCC_CSOPORT) %>%
summarise(sum = mean(sum))%>%
mutate(type = "mean")
library(dplyr)
ugyfelID <- 101553
szegmens <- ugyfel[UGYFEL_ID == ugyfelID, .(UGYFEL_NEME,UGYFEL_CSALADI_ALLAPOT,UGYFEL_ISKOLAI_VEGZETTSEGE)]
szegmens
ugyfelID <- 2259345
szegmens <- ugyfel[UGYFEL_ID == ugyfelID, .(UGYFEL_NEME,UGYFEL_CSALADI_ALLAPOT,UGYFEL_ISKOLAI_VEGZETTSEGE)]
szegmens
szegmens_ugyfelID<- ugyfel[UGYFEL_NEME == szegmens$UGYFEL_NEME &
UGYFEL_CSALADI_ALLAPOT == szegmens$UGYFEL_CSALADI_ALLAPOT &
UGYFEL_ISKOLAI_VEGZETTSEGE == szegmens$UGYFEL_ISKOLAI_VEGZETTSEGE,UGYFEL_ID]
szegmens_ugyfelID
ugyfeltranzakcio_havi %>% group_by(MCC_CSOPORT) %>% summarise(sum = sum(TRX_OSSZEG))
tranzakcio_havi
library(data.table)
szegmens_ugyfelID<- ugyfel[UGYFEL_NEME == szegmens$UGYFEL_NEME &
UGYFEL_CSALADI_ALLAPOT == szegmens$UGYFEL_CSALADI_ALLAPOT &
UGYFEL_ISKOLAI_VEGZETTSEGE == szegmens$UGYFEL_ISKOLAI_VEGZETTSEGE,UGYFEL_ID]
ugyfeltranzakcio_havi %>% group_by(MCC_CSOPORT) %>% summarise(sum = sum(TRX_OSSZEG))
ugyfeltranzakcio_havi
mean_tranzakcio_havi <- tranzakcio_havi %>% group_by(UGYFEL_ID,MCC_CSOPORT) %>%
summarise(sum = sum(TRX_OSSZEG)) %>% group_by(MCC_CSOPORT) %>%
summarise(sum = mean(sum))%>%
mutate(type = "mean")
mean_szegmens_tranzakcio_havi <- tranzakcio_havi %>% filter(UGYFEL_ID %in% szegmens_ugyfelID) %>%
group_by(UGYFEL_ID,MCC_CSOPORT) %>%
summarise(sum = sum(TRX_OSSZEG)) %>%
group_by(MCC_CSOPORT) %>% summarise(sum = mean(sum)) %>%
mutate(type = "szegmens")
ugyfeltranzakcio_havi <- tranzakcio_havi[UGYFEL_ID == ugyfelID]
ugyfeltranzakcio_havi <- ugyfeltranzakcio_havi %>% group_by(MCC_CSOPORT) %>% summarise(sum = sum(TRX_OSSZEG)) %>% mutate(type = "sajat")
data <- full_join(mean_tranzakcio_havi,ugyfeltranzakcio_havi)
data <- full_join(data,mean_szegmens_tranzakcio_havi)
p <-plot_ly(data, r = ~sum, t = ~MCC_CSOPORT) %>% add_area(color = ~type, labels = c("1","2"))
layout(p,  orientation = 270)
data <- full_join(mean_tranzakcio_havi,ugyfeltranzakcio_havi)
data <- full_join(data,mean_szegmens_tranzakcio_havi)
p <-plot_ly(data, r = ~sum, t = ~MCC_CSOPORT) %>% add_area(color = ~type, labels = c("1","2"))
p <-plot_ly(data, r = ~sum, t = ~MCC_CSOPORT) %>% add_area(color = ~type)
library(plotly)
p <-plot_ly(data, r = ~sum, t = ~MCC_CSOPORT) %>% add_area(color = ~type)
layout(p,  orientation = 270)
View(data)
G20
ugyfeltranzakcio_havi
tranzakcio_havi[UGYFEL_ID == ugyfelID]
tranzakcio_havi[UGYFEL_ID == ugyfelID] %>% group_by(MCC_CSOPORT,PARTNER) %>% summarise(sum = sum(TRX_OSSZEG), ferq = sum(TRX_DB))
data2 <- tranzakcio_havi[UGYFEL_ID == ugyfelID] %>% group_by(MCC_CSOPORT,PARTNER) %>% summarise(sum = sum(TRX_OSSZEG), ferq = sum(TRX_DB))
G20
ggplot(data2, aes(area = sum, fill = freq, label = PARTNER,
subgroup = MCC_CSOPORT)) +
geom_treemap() +
ggplot(data2, aes(area = sum, fill = freq, label = PARTNER,
subgroup = MCC_CSOPORT)) +
geom_treemap()
data2
ggplot(data2, aes(area = sum, fill = ferq, label = PARTNER,
subgroup = MCC_CSOPORT)
ggplot(data2, aes(area = sum, fill = ferq, label = PARTNER,
subgroup = MCC_CSOPORT))
ggplot(data2, aes(area = sum, fill = ferq, label = PARTNER,
subgroup = MCC_CSOPORT)) +
geom_treemap()
ggplot(data2, aes(area = sum, fill = ferq, label = PARTNER,
subgroup = MCC_CSOPORT)) +
geom_treemap() +
geom_treemap_subgroup_border()
ggplot(data2, aes(area = sum, fill = ferq, label = PARTNER,
subgroup = MCC_CSOPORT)) +
geom_treemap() +
geom_treemap_subgroup_border() +
geom_treemap_subgroup_text(place = "centre", grow = T, alpha = 0.5, colour =
"black", fontface = "italic", min.size = 0) +
geom_treemap_text(colour = "white", place = "topleft", reflow = T)
ggplot(data2, aes(area = sum, fill = MCC_CSOPORT, label = PARTNER,
subgroup = MCC_CSOPORT)) +
geom_treemap() +
geom_treemap_subgroup_border() +
geom_treemap_subgroup_text(place = "centre", grow = T, alpha = 0.5, colour =
"black", fontface = "italic", min.size = 0) +
geom_treemap_text(colour = "white", place = "topleft", reflow = T)
